# Ассемблер и интерпретатор для учебной виртуальной машины (УВМ)

Этот проект реализует ассемблер и интерпретатор для учебной виртуальной машины (УВМ). Ассемблер преобразует текстовый код в бинарный формат, а интерпретатор выполняет бинарные команды УВМ и записывает результаты выполнения в указанный диапазон памяти.

## Возможности
- **Ассемблер:**
  - Принимает текстовый файл с исходным кодом.
  - Генерирует бинарный файл с машинными инструкциями.
  - Записывает файл-лог в формате XML со списком инструкций в формате "ключ=значение".
- **Интерпретатор:**
  - Загружает бинарный файл с машинными командами.
  - Выполняет инструкции УВМ.
  - Сохраняет значения памяти в указанном диапазоне в формате XML.

## Система команд УВМ
### 1. Загрузка константы
- **Описание:**
  - Загружает константу (поле C) в регистр (поле B).
- **Формат команды:**
  - Размер: 4 байта.
  - Поля:
    - A (3 бита): Код операции (3).
    - B (4 бита): Адрес регистра.
    - C (19 бит): Константа.
- **Тест:**
  ```
  Входные параметры: A=3, B=9, C=100
  Бинарный код: 0x4B, 0x32, 0x00, 0x00
  ```

### 2. Чтение значения из памяти
- **Описание:**
  - Читает значение из памяти (поле C) в регистр (поле B).
- **Формат команды:**
  - Размер: 4 байта.
  - Поля:
    - A (3 бита): Код операции (5).
    - B (4 бита): Адрес регистра.
    - C (19 бит): Адрес памяти.
- **Тест:**
  ```
  Входные параметры: A=5, B=7, C=403
  Бинарный код: 0xBD, 0xC9, 0x00, 0x00
  ```

### 3. Запись значения в память
- **Описание:**
  - Записывает значение из регистра (поле C) в память (поле B).
- **Формат команды:**
  - Размер: 4 байта.
  - Поля:
    - A (3 бита): Код операции (0).
    - B (4 бита): Адрес памяти.
    - C (4 бита): Адрес регистра.
- **Тест:**
  ```
  Входные параметры: A=0, B=11, C=0
  Бинарный код: 0x58, 0x00, 0x00, 0x00
  ```

### 4. Бинарная операция: "<"
- **Описание:**
  - Выполняет сравнение между регистром (поле B) и значением из памяти (поле C + поле D).
- **Формат команды:**
  - Размер: 4 байта.
  - Поля:
    - A (3 бита): Код операции (6).
    - B (4 бита): Адрес регистра результата.
    - C (4 бита): Адрес регистра.
    - D (16 бит): Смещение.
- **Тест:**
  ```
  Входные параметры: A=6, B=10, C=10, D=904
  Бинарный код: 0x56, 0x45, 0x1C, 0x00
  ```

## Тестовая программа
### Задача:
- Поэлементно выполнить операцию "<" над двумя векторами длины 8.
- Сохранить результат в первый вектор.

### Пример исходного кода:
```asm
LOAD_CONST R1, 8       ; Загрузка длины вектора
LOAD_MEM R2, VECTOR1   ; Загрузка первого вектора
LOAD_MEM R3, VECTOR2   ; Загрузка второго вектора
LOOP_START:
CMP_LT R4, R2, R3      ; Сравнение текущих элементов
STORE_MEM R4, VECTOR1  ; Запись результата в первый вектор
INC R2                 ; Инкремент указателя первого вектора
INC R3                 ; Инкремент указателя второго вектора
DEC R1                 ; Уменьшение счётчика длины
JNZ LOOP_START         ; Переход на начало цикла
HALT
```

## Структура проекта
```
project/
├── assembler.py            # Ассемблер
├── interpreter.py          # Интерпретатор
├── tests/                  # Тесты для всех команд
├── examples/               # Примеры исходных и бинарных файлов
├── logs/                   # XML-логи
└── README.md               # Документация
```

## Аргументы командной строки
### Ассемблер
- `--input_path`: Путь к файлу с текстом исходной программы.
- `--output_path`: Путь к бинарному файлу с машинными инструкциями.
- `--log_path`: Путь к файлу-логу в формате XML.

### Интерпретатор
- `--binary_path`: Путь к бинарному файлу с командами.
- `--memory_range`: Диапазон адресов памяти для сохранения результата (например, `0-100`).
- `--output_path`: Путь к файлу-результату в формате XML.

## Тестирование
- Для каждой команды реализованы тесты, включая:
  - Проверку корректной сборки инструкций.
  - Выполнение инструкций на интерпретаторе.
- Запуск тестов:
```bash
pytest tests/
```

## Лицензия
Проект лицензирован на условиях MIT License. Подробности см. в файле `LICENSE`.

